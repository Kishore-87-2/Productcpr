<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thermal Camera Comparison</title>
    <!-- jsPDF + autoTable -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root {
            --blue: #007bff;
            --light-blue: #e7f3ff;
            --white: #ffffff;
            --border-blue: #cce5ff;
            --text: #1a1a1a;
            --gray-bg: #f8fbff;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--gray-bg);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            color: var(--text);
        }

        .container {
            background-color: var(--white);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 123, 255, 0.1);
            width: 100%;
            max-width: 1400px;
            border: 1px solid var(--border-blue);
        }

        h1 {
            margin: 0 0 30px 0;
            font-size: 2rem;
            text-align: center;
            font-weight: 600;
            background: linear-gradient(90deg, var(--blue), #00c4ff);
            -webkit-background-clip: text;
            color: transparent;
        }

        .dropdowns {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 18px;
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--blue);
            font-size: 0.95rem;
        }

        select {
            width: 100%;
            padding: 12px;
            border: 1.5px solid var(--border-blue);
            border-radius: 8px;
            background-color: var(--white);
            font-size: 1rem;
            transition: all 0.3s;
        }

        select:focus {
            outline: none;
            border-color: var(--blue);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2);
        }

        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin-bottom: 25px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            background-color: var(--blue);
            color: var(--white);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        button:hover:not(:disabled) {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: var(--white);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
            z-index: 100;
            margin-bottom: 8px;
        }

        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }

        .comparison-result {
            margin-top: 20px;
            overflow-x: auto;
            max-height: 600px;
            border-radius: 10px;
            border: 1px solid var(--border-blue);
            background-color: var(--light-blue);
            padding: 12px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.92rem;
            background-color: var(--white);
        }

        th, td {
            padding: 14px;
            border: 1px solid var(--border-blue);
            text-align: left;
            vertical-align: top;
        }

        th {
            background-color: var(--blue);
            color: var(--white);
            position: sticky;
            top: 0;
            z-index: 10;
            font-weight: 600;
        }

        tr:nth-child(even) td {
            background-color: #f5fbff;
        }

        h3 {
            margin: 0 0 15px 0;
            color: var(--blue);
            font-size: 1.3rem;
            text-align: center;
            font-weight: 600;
        }

        .loading {
            display: none;
            margin: 20px auto;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--blue);
            border-radius: 50%;
            width: 36px;
            height: 36px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .notification {
            display: none;
            margin-top: 15px;
            padding: 12px;
            background-color: #28a745;
            color: var(--white);
            border-radius: 8px;
            text-align: center;
            font-size: 0.95rem;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .dropdowns { grid-template-columns: 1fr; }
            .buttons { flex-direction: column; align-items: center; }
            button { width: 100%; max-width: 300px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Sonel KT 520 vs Competitors</h1>

        <div class="dropdowns">
            <div>
                <label for="product">Select Sonel Product:</label>
                <select id="product"></select>
            </div>
            <div>
                <label for="competitor1">Competitor 1:</label>
                <select id="competitor1"></select>
            </div>
            <div>
                <label for="competitor2">Competitor 2:</label>
                <select id="competitor2"></select>
            </div>
        </div>

        <div class="buttons">
            <button class="tooltip" onclick="compareSelectedProducts()" data-tooltip="Compare selected products">Compare Selected</button>
            <button class="tooltip" onclick="compareAllProducts()" data-tooltip="Compare all products">Compare All</button>
            <button class="tooltip" onclick="exportSelectedToPDF()" data-tooltip="Export selected to PDF">Export Selected</button>
            <button class="tooltip" onclick="exportAllToPDF()" data-tooltip="Export all to PDF (in chunks)">Export All</button>
            <button class="tooltip" onclick="clearSelections()" data-tooltip="Reset all selections">Clear Selection</button>
        </div>

        <div id="loading" class="loading"></div>
        <div id="notification" class="notification"></div>
        <div id="comparisonResult" class="comparison-result"></div>
    </div>

    <script>
        const products = {
            "Sonel KT 520": {
                "Infrared resolution": "320x240",
                "Super resolution": "640x480",
                "Display screen": "4.3\", 800x480 pixel touchscreen LCD",
                "Detector type": "7.5to 14um",
                "Field of view": "25°x19°",
                "Min. object distance": "0.1m",
                "Focusing mode": "Manual / Automatic / Touch autofocus / Continuous autofocus",
                "Digital zoom": "1.1xto 8x",
                "Shot recognition": "Auto",
                "Measurement range": "-40°C to 150°C, 0°C to 650°C Optional 500°C to 2000°C",
                "Accuracy": "±2°C or 2%",
                "Others": "Isothermals, Smart Stroke, Intelligently calculate the area",
                "Image mode": "IR, VIS, MIF, PIP"
            },
            "Flir E8pro": {
                "Infrared resolution": "320x240",
                "Super resolution": "NA",
                "Display screen": "3.5 inch, 640 × 480 color LCD",
                "Detector type": "7.5–13 µm",
                "Field of view": "33° × 25°",
                "Min. object distance": "0.36 m",
                "Focusing mode": "Focus free",
                "Digital zoom": "NA",
                "Shot recognition": "NA",
                "Measurement range": "-20°C to 550°C",
                "Accuracy": "±2°C or 2%",
                "Others": "NA",
                "Image mode": "IR, VIS, MIF, PIP"
            },
            "Flir E54": {
                "Infrared resolution": "320x240",
                "Super resolution": "NA",
                "Display screen": "4 in.640 × 480 color LCD",
                "Detector type": "7.5–14 µm",
                "Field of view": "24° × 18°",
                "Min. object distance": "0.15 m",
                "Focusing mode": "Manual",
                "Digital zoom": "1–4× continuous",
                "Shot recognition": "NA",
                "Measurement range": "-20°C to 650°C",
                "Accuracy": "±2°C or 2%",
                "Others": "NA",
                "Image mode": "IR, VIS, MIF, PIP"
            },
            "Flir E76": {
                "Infrared resolution": "320x240",
                "Super resolution": "NA",
                "Display screen": "4 in.640 × 480 color LCD",
                "Detector type": "7.5–14 µm",
                "Field of view": "24° × 18°",
                "Min. object distance": "0.15 m",
                "Focusing mode": "Manual",
                "Digital zoom": "1–4× continuous",
                "Shot recognition": "NA",
                "Measurement range": "-20°C to 650°C Optional 300 to 1000°C",
                "Accuracy": "±2°C or 2%",
                "Others": "NA",
                "Image mode": "IR, VIS, MIF, PIP"
            },
            "Fluke Ti300+": {
                "Infrared resolution": "320x240",
                "Super resolution": "Available",
                "Display screen": "3.5 inch (landscape), 640 x 480 LCD",
                "Detector type": "7.5 um to 14 um",
                "Field of view": "34° H x 24° V",
                "Min. object distance": "0.15 m",
                "Focusing mode": "Auto and manual",
                "Digital zoom": "NA",
                "Shot recognition": "NA",
                "Measurement range": "-20 °C to 650 °C",
                "Accuracy": "±2°C or 2%",
                "Others": "NA",
                "Image mode": "IR, VIS, MIF"
            },
            "Fluke TiS60+": {
                "Infrared resolution": "320x240",
                "Super resolution": "Available",
                "Display screen": "3.5 inch (8.9 cm landscape) 320 x 240 LCD",
                "Detector type": "7.5–14 µm",
                "Field of view": "34.1 °H x 25.6 °V",
                "Min. object distance": "46 cm",
                "Focusing mode": "Auto and manual",
                "Digital zoom": "NA",
                "Shot recognition": "NA",
                "Measurement range": "-20 °C to 400 °C",
                "Accuracy": "±2°C or 2%",
                "Others": "NA",
                "Image mode": "IR, VIS, MIF, PIP"
            },
            "Testo 872": {
                "Infrared resolution": "320x240",
                "Super resolution": "640 x 480",
                "Display screen": "8.9 cm (3.5\") TFT, QVGA (320 x 240 pixels)",
                "Detector type": "7.5 to14 µm",
                "Field of view": "42° x 30°",
                "Min. object distance": "< 0.5 m",
                "Focusing mode": "Fixed focus",
                "Digital zoom": "NA",
                "Shot recognition": "NA",
                "Measurement range": "-20 to +650 °C",
                "Accuracy": "±2 °C or 2 %",
                "Others": "NA",
                "Image mode": "IR, VIS"
            },
            "Testo 883": {
                "Infrared resolution": "320x240",
                "Super resolution": "640 x 480",
                "Display screen": "8.9 cm (3.5\") TFT, QVGA (320 x 240 pixels)",
                "Detector type": "7.5 to14 µm",
                "Field of view": "30° x 23°",
                "Min. object distance": "< 0.1 m",
                "Focusing mode": "manual",
                "Digital zoom": "2x, 3x, 4x",
                "Shot recognition": "NA",
                "Measurement range": "-30 to +650 °C",
                "Accuracy": "±2 °C or 2 %",
                "Others": "NA",
                "Image mode": "IR image / real image / overlay"
            }
        };

        const sonelProducts = ["Sonel KT 520"];

        function initializeDropdowns() {
            const productSelect = document.getElementById("product");
            const comp1 = document.getElementById("competitor1");
            const comp2 = document.getElementById("competitor2");

            sonelProducts.forEach(p => productSelect.add(new Option(p, p)));
            Object.keys(products).forEach(p => {
                comp1.add(new Option(p, p));
                comp2.add(new Option(p, p));
            });

            comp2.add(new Option("None", "None"), 0);
            comp2.value = "None";

            productSelect.addEventListener("change", updateDropdowns);
            comp1.addEventListener("change", updateDropdowns);
            comp2.addEventListener("change", updateDropdowns);
        }

        function updateDropdowns() {
            const product = document.getElementById("product").value;
            const comp1 = document.getElementById("competitor1").value;
            const comp2 = document.getElementById("competitor2").value;

            const pSelect = document.getElementById("product");
            const c1Select = document.getElementById("competitor1");
            const c2Select = document.getElementById("competitor2");

            pSelect.innerHTML = ""; c1Select.innerHTML = ""; c2Select.innerHTML = "";

            sonelProducts.forEach(p => {
                if (p !== comp1 && p !== comp2) pSelect.add(new Option(p, p));
            });

            Object.keys(products).forEach(p => {
                if (p !== product && p !== comp2) c1Select.add(new Option(p, p));
                if (p !== product && p !== comp1) c2Select.add(new Option(p, p));
            });

            c2Select.add(new Option("None", "None"), 0);
            pSelect.value = product; c1Select.value = comp1; c2Select.value = comp2;
        }

        function clearSelections() {
            document.getElementById("product").selectedIndex = 0;
            document.getElementById("competitor1").selectedIndex = 0;
            document.getElementById("competitor2").value = "None";
            document.getElementById("comparisonResult").innerHTML = "";
            updateDropdowns();
        }

        function showNotification(msg) {
            const n = document.getElementById("notification");
            n.textContent = msg;
            n.style.display = "block";
            setTimeout(() => n.style.display = "none", 3000);
        }

        function toggleLoading(show) {
            document.getElementById("loading").style.display = show ? "block" : "none";
            document.querySelectorAll("button").forEach(b => b.disabled = show);
        }

        function compareSelectedProducts() {
            const product = document.getElementById("product").value;
            const comp1 = document.getElementById("competitor1").value;
            const comp2 = document.getElementById("competitor2").value;

            if (!product || !comp1) return showNotification("Please select a Sonel product and at least one competitor.");

            const resultDiv = document.getElementById("comparisonResult");
            let headers = [`<th>Feature</th><th>${product}</th><th>${comp1}</th>`];
            if (comp2 !== "None") headers.push(`<th>${comp2}</th>`);

            let tableHTML = `<h3>Comparison Result</h3><table><tr>${headers.join("")}</tr>`;

            Object.keys(products[product]).forEach(f => {
                tableHTML += `<tr><td><strong>${f}</strong></td><td>${products[product][f]}</td><td>${products[comp1][f]}</td>`;
                if (comp2 !== "None") tableHTML += `<td>${products[comp2][f]}</td>`;
                tableHTML += `</tr>`;
            });

            tableHTML += `</table>`;
            resultDiv.innerHTML = tableHTML;
        }

        function compareAllProducts() {
            const resultDiv = document.getElementById("comparisonResult");
            const all = Object.keys(products);
            let tableHTML = `<h3>All Products Comparison</h3><table><tr><th>Feature</th>${all.map(p => `<th>${p}</th>`).join("")}</tr>`;

            Object.keys(products[all[0]]).forEach(f => {
                tableHTML += `<tr><td><strong>${f}</strong></td>${all.map(p => `<td>${products[p][f]}</td>`).join("")}</tr>`;
            });

            tableHTML += `</table>`;
            resultDiv.innerHTML = tableHTML;
        }

        async function exportSelectedToPDF() {
            toggleLoading(true);
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('l', 'mm', 'a4');

            const product = document.getElementById("product").value;
            const comp1 = document.getElementById("competitor1").value;
            const comp2 = document.getElementById("competitor2").value;

            if (!product || !comp1) {
                toggleLoading(false);
                return showNotification("Please select a Sonel product and at least one competitor.");
            }

            let headers = ["Feature", product, comp1];
            let rows = Object.keys(products[product]).map(f => [f, products[product][f], products[comp1][f]]);
            if (comp2 !== "None") {
                headers.push(comp2);
                rows = rows.map((r, i) => [...r, products[comp2][Object.keys(products[product])[i]]]);
            }

            doc.setFontSize(18);
            doc.setTextColor(0, 123, 255);
            doc.text("Sonel KT 520 vs Competitors", 14, 15);

            doc.autoTable({
                head: [headers],
                body: rows,
                startY: 25,
                theme: 'grid',
                styles: { fontSize: 9.5, cellPadding: 4 },
                headStyles: { fillColor: [0, 123, 255], textColor: 255 },
                alternateRowStyles: { fillColor: [240, 248, 255] },
                columnStyles: { 0: { fontStyle: 'bold' } }
            });

            doc.save(`KT520_vs_${comp1.replace(/ /g, '_')}.pdf`);
            toggleLoading(false);
            showNotification("Selected comparison exported!");
        }

        async function exportAllToPDF() {
            toggleLoading(true);
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('l', 'mm', 'a4');
            const all = Object.keys(products);
            const features = Object.keys(products[all[0]]);
            const chunkSize = 5;

            for (let i = 0; i < all.length; i += chunkSize) {
                const chunk = all.slice(i, i + chunkSize);
                if (i > 0) doc.addPage();

                const headers = ["Feature", ...chunk];
                const rows = features.map(f => [f, ...chunk.map(p => products[p][f])]);

                doc.setFontSize(16);
                doc.setTextColor(0, 123, 255);
                doc.text("All 320x240 Thermal Cameras", 14, 15);

                doc.autoTable({
                    head: [headers],
                    body: rows,
                    startY: 25,
                    theme: 'grid',
                    styles: { fontSize: 8, cellPadding: 3 },
                    headStyles: { fillColor: [0, 123, 255], textColor: 255 },
                    alternateRowStyles: { fillColor: [240, 248, 255] },
                    columnStyles: { 0: { fontStyle: 'bold' } }
                });
            }

            doc.save("All_320x240_Cameras.pdf");
            toggleLoading(false);
            showNotification("All comparisons exported!");
        }

        window.onload = initializeDropdowns;
    </script>
</body>
</html>
