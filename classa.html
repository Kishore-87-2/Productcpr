<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Quality Analyzer Comparison</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            position: relative;
        }
        
        .export-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-size: 14px;
        }

        .export-btn:hover {
            background-color: #0056b3;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f4f4f4;
        }

        select {
            padding: 8px;
            margin: 10px;
        }
        
        .compare-all-btn {
            padding: 10px 15px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 14px;
            margin-top: 15px;
            border-radius: 5px;
        }

        .compare-all-btn:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>
    <button class="export-btn" onclick="exportToPDF()">Export</button>

    <h1>Power Quality Analyzer Comparison</h1>

    <label for="productSelect">Select Product:</label>
    <select id="productSelect" onchange="updateCompetitorOptions()">
        <option value="SONEL PQM-711">SONEL PQM-711</option>
    </select>

    <label for="competitorSelect">Select Competitor 1:</label>
    <select id="competitorSelect" onchange="loadComparisonTable()"></select>

    <label for="competitorSelect2">Select Competitor 2:</label>
    <select id="competitorSelect2" onchange="loadComparisonTable()"></select>

    <button class="compare-all-btn" onclick="compareAllProducts()">Compare All Products</button>

    <table id="comparisonTable"></table>

    <script>
        const productComparisonData = {
            "SONEL PQM-711": {
                "Type of Power analyzer": "Three phase",
                "Number of Current Channels (Nos.)": 4,
                "Number of Voltage Channels": 5,
                "Measurable current range (with clamp)": "6000 Ampere",
                "Measurable voltage range": "1000 Volt",
                "Measurable voltage resolution": "0.1 Volt",
                "Measurable voltage accuracy": "0.1%",
                "Measurable current accuracy (%)": "0.5%",
                "Display type": "Color LCD (Tablet Optional)",
                "Mobile app for live data": "Available",
                "GSM for remote operation": "Available",
                "Order(n) to which Facility to Measure Harmonics available": "Upto 50th",
                "Facility to Measure Transient Voltage": "8kV",
                "Facility to Measure Active, Reactive and Apparent Energy": "Available",
                "Facility to Measure Active, Reactive and Apparent Power": "Available"
            },
            "SONEL PQM-710": {
                "Type of Power analyzer": "Three phase",
                "Number of Current Channels (Nos.)": 4,
                "Number of Voltage Channels": 5,
                "Measurable current range (with clamp)": "6000 Ampere",
                "Measurable voltage range": "1000 Volt",
                "Measurable voltage resolution": "0.1 Volt",
                "Measurable voltage accuracy": "0.1%",
                "Measurable current accuracy (%)": "0.5%",
                "Display type": "Color LCD (Tablet Optional)",
                "Mobile app for live data": "Available",
                "GSM for remote operation": "Available",
                "Order(n) to which Facility to Measure Harmonics available": "Upto 50th",
                "Facility to Measure Transient Voltage": "Not Applicable",
                "Facility to Measure Active, Reactive and Apparent Energy": "Available",
                "Facility to Measure Active, Reactive and Apparent Power": "Available"
            },
            "Fluke 1773": {
                "Type of Power analyzer": "Three phase",
                "Number of Current Channels (Nos.)": 4,
                "Number of Voltage Channels": 5,
                "Measurable current range (with clamp)": "6000 Ampere",
                "Measurable voltage range": "1000 V",
                "Measurable voltage resolution": "0.1V",
                "Measurable voltage accuracy": "0.1%",
                "Measurable current accuracy (%)": "NM",
                "Display type": "7'' TFT colour Touch Display",
                "Mobile app for live data": "Not available",
                "GSM for remote operation": "Not available",
                "Order(n) to which Facility to Measure Harmonics available": "Up to 50th",
                "Facility to Measure Transient Voltage": "No",
                "Facility to Measure Active, Reactive and Apparent Energy": "Available",
                "Facility to Measure Active, Reactive and Apparent Power": "Available"
            },
            "Fluke 1775": {
                "Type of Power analyzer": "Three phase",
                "Number of Current Channels (Nos.)": 4,
                "Number of Voltage Channels": 5,
                "Measurable current range (with clamp)": "6000 Ampere",
                "Measurable voltage range": "1000V",
                "Measurable voltage resolution": "0.1V",
                "Measurable voltage accuracy": "0.1%",
                "Measurable current accuracy (%)": "NM",
                "Display type": "7'' TFT colour Touch Display",
                "Mobile app for live data": "Not available",
                "GSM for remote operation": "Not available",
                "Order(n) to which Facility to Measure Harmonics available": "Up to 50th",
                "Facility to Measure Transient Voltage": "8kV",
                "Facility to Measure Active, Reactive and Apparent Energy": "Available",
                "Facility to Measure Active, Reactive and Apparent Power": "Available"
            },
            "Fluke 1777": {
                "Type of Power analyzer": "Three phase",
                "Number of Current Channels (Nos.)": 4,
                "Number of Voltage Channels": 5,
                "Measurable current range (with clamp)": "6000 Ampere",
                "Measurable voltage range": "1000V",
                "Measurable voltage resolution": "0.1V",
                "Measurable voltage accuracy": "0.1%",
                "Measurable current accuracy (%)": "NM",
                "Display type": "7'' TFT colour Touch Display",
                "Mobile app for live data": "Not available",
                "GSM for remote operation": "Not available",
                "Order(n) to which Facility to Measure Harmonics available": "Up to 50th",
                "Facility to Measure Transient Voltage": "8kV",
                "Facility to Measure Active, Reactive and Apparent Energy": "Available",
                "Facility to Measure Active, Reactive and Apparent Power": "Available"
            },
            "HIOKI -3198": {
                "Type of Power analyzer": "Three phase",
                "Number of Current Channels (Nos.)": 4,
                "Number of Voltage Channels": 5,
                "Measurable current range (with clamp)": "6000 Ampere",
                "Measurable voltage range": "1000V",
                "Measurable voltage resolution": "0.1V",
                "Measurable voltage accuracy": "0.1%",
                "Measurable current accuracy (%)": "0.2%",
                "Display type": "LCD",
                "Mobile app for live data": "Not available",
                "GSM for remote operation": "Not available",
                "Order(n) to which Facility to Measure Harmonics available": "Up to 50th",
                "Facility to Measure Transient Voltage": "±6kV with 2 MHZ",
                "Facility to Measure Active, Reactive and Apparent Energy": "Available",
                "Facility to Measure Active, Reactive and Apparent Power": "Available"
            },

            "Kusam-Meco-KM-2300": {
                "Type of Power analyzer": "Three phase",
                "Number of Current Channels (Nos.)": 4,
                "Number of Voltage Channels": 4,
                "Measurable current range (with clamp)": "3000A",
                "Measurable voltage range": "1000V",
                "Measurable voltage resolution": "0.1V",
                "Measurable voltage accuracy": "0.10%",
                "Measurable current accuracy (%)": "1%",
                "Display type": "LCD",
                "Mobile app for live data": "Not available",
                "GSM for remote operation": "Not available",
                "Order(n) to which Facility to Measure Harmonics available": "Available",
                "Facility to Measure Transient Voltage": "±6000Vpk with 163.84kHz",
                "Facility to Measure Active, Reactive and Apparent Energy": "Available",
                "Facility to Measure Active, Reactive and Apparent Power": "Available"
            }
        };

        function loadComparisonTable() {
            const selectedProduct = document.getElementById("productSelect").value;
            const selectedCompetitor = document.getElementById("competitorSelect").value;
            const selectedCompetitor2 = document.getElementById("competitorSelect2").value;

            let tableContent = `<tr><th>Feature</th><th>${selectedProduct}</th><th>${selectedCompetitor}</th><th>${selectedCompetitor2}</th></tr>`;

            const productData = productComparisonData[selectedProduct];
            const competitor1Data = productComparisonData[selectedCompetitor] || {};
            const competitor2Data = productComparisonData[selectedCompetitor2] || {};

            const features = [
                "Type of Power analyzer",
                "Number of Current Channels (Nos.)",
                "Number of Voltage Channels",
                "Measurable current range (with clamp)",
                "Measurable voltage range",
                "Measurable voltage resolution",
                "Measurable voltage accuracy",
                "Measurable current accuracy (%)",
                "Display type",
                "Mobile app for live data",
                "GSM for remote operation",
                "Order(n) to which Facility to Measure Harmonics available",
                "Facility to Measure Transient Voltage",
                "Facility to Measure Active, Reactive and Apparent Energy",
                "Facility to Measure Active, Reactive and Apparent Power"
            ];

            features.forEach((feature) => {
                tableContent += `<tr><td>${feature}</td><td>${productData[feature]}</td><td>${competitor1Data[feature] || "N/A"}</td><td>${competitor2Data[feature] || "N/A"}</td></tr>`;
            });

            document.getElementById("comparisonTable").innerHTML = tableContent;
        }

        function updateCompetitorOptions() {
            const productSelect = document.getElementById("productSelect");
            const selectedProduct = productSelect.value;

            const competitorSelect = document.getElementById("competitorSelect");
            const competitorSelect2 = document.getElementById("competitorSelect2");

            competitorSelect.innerHTML = '';
            competitorSelect2.innerHTML = '';

            const competitors = Object.keys(productComparisonData).filter(product => product !== selectedProduct);

            competitors.forEach(competitor => {
                const option = document.createElement("option");
                option.value = competitor;
                option.text = competitor;
                competitorSelect.appendChild(option);

                const option2 = document.createElement("option");
                option2.value = competitor;
                option2.text = competitor;
                competitorSelect2.appendChild(option2);
            });

            loadComparisonTable();
        }

        function compareAllProducts() {
            const selectedProduct = document.getElementById("productSelect").value;
            const competitors = Object.keys(productComparisonData).filter(product => product !== selectedProduct);

            let tableContent = `<tr><th>Feature</th><th>${selectedProduct}</th>`;

            competitors.forEach((competitor) => {
                tableContent += `<th>${competitor}</th>`;
            });

            tableContent += `</tr>`;

            const productData = productComparisonData[selectedProduct];

            const features = [
                "Type of Power analyzer",
                "Number of Current Channels (Nos.)",
                "Number of Voltage Channels",
                "Measurable current range (with clamp)",
                "Measurable voltage range",
                "Measurable voltage resolution",
                "Measurable voltage accuracy",
                "Measurable current accuracy (%)",
                "Display type",
                "Mobile app for live data",
                "GSM for remote operation",
                "Order(n) to which Facility to Measure Harmonics available",
                "Facility to Measure Transient Voltage",
                "Facility to Measure Active, Reactive and Apparent Energy",
                "Facility to Measure Active, Reactive and Apparent Power"
            ];

            features.forEach((feature) => {
                tableContent += `<tr><td>${feature}</td><td>${productData[feature]}</td>`;

                competitors.forEach((competitor) => {
                    const competitorData = productComparisonData[competitor];
                    tableContent += `<td>${competitorData[feature] || "N/A"}</td>`;
                });

                tableContent += `</tr>`;
            });

            document.getElementById("comparisonTable").innerHTML = tableContent;
        }

        function exportToPDF() {
            html2canvas(document.querySelector("body")).then(function(canvas) {
                const pdf = new jsPDF();
                pdf.addImage(canvas.toDataURL(), "JPEG", 0, 0);
                pdf.save("product_comparison.pdf");
            });
        }

        window.onload = updateCompetitorOptions;
    </script>
</body>
</html>
